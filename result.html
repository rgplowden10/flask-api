<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signature Verification Result</title>
</head>
<body>
    <h2>Signature Verification Result</h2>

    <h3>User Image:</h3>
    <img id="user-image" src="" alt="User uploaded image" style="max-width: 300px; display: none;">

    <h3>Similar Reference Images:</h3>
    <div id="similar-images"></div>

    <h3>Confidence Score:</h3>
    <p id="confidence-score"></p>

    <h3 style="color: red;" id="error-message"></h3>

    <button onclick="goBack()">Verify Another Signature</button>

    <script>
        // Load results from localStorage
        let resultData = localStorage.getItem("verification_result");

        if (resultData) {
            try {
                resultData = JSON.parse(resultData);

                if (resultData.error) {
                    document.getElementById("error-message").innerText = resultData.error;
                } else {
                    if (resultData.input_image_url) {
                        let userImage = document.getElementById("user-image");
                        userImage.src = resultData.input_image_url;
                        userImage.style.display = "block"; // Show the image if available
                    }

                    document.getElementById("confidence-score").innerText = 
                        resultData.confidence_score ? `Confidence: ${resultData.confidence_score}` : "Confidence score unavailable.";

                    const similarImagesContainer = document.getElementById("similar-images");
                    if (resultData.similar_images && resultData.similar_images.length > 0) {
                        resultData.similar_images.forEach(imageUrl => {
                            let imgElement = document.createElement("img");
                            imgElement.src = imageUrl;
                            imgElement.style.maxWidth = "200px";
                            imgElement.style.margin = "10px";
                            similarImagesContainer.appendChild(imgElement);
                        });
                    } else {
                        similarImagesContainer.innerText = "No similar images found.";
                    }
                }
            } catch (error) {
                console.error("Error parsing result data:", error);
                document.getElementById("error-message").innerText = "Could not load verification results.";
            }
        } else {
            document.getElementById("error-message").innerText = "No verification results found in localStorage.";
        }

        function goBack() {
            window.location.href = "index.html";
        }
    </script>
</body>
</html>
